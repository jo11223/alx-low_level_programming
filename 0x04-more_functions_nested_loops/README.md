More Functions and more nested loops
